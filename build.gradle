/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

plugins {
    id 'war'
}

war {
    archiveFileName = 'test.war'
}

repositories {
    mavenLocal()
    mavenCentral()
}

dependencies {
 compile group: 'commons-io', name: 'commons-io', version: '2.6'
 compile group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.13.3'
 compile group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.13.3'
 compile group: 'org.slf4j', name: 'slf4j-log4j12', version: '1.7.30'
 compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.30'

}

processResources  {
 doLast{
    new File(buildDir, "resources/main/greeting.txt").text = version
 }
}

 task sorting {
 doLast{
  def unsortedArray = [
   '1.1.3',
   '1.1.0',
   '1.10.2',
   '1.9.1',
   '1.1.8',
   '1.1.15'
  ]

  println unsortedArray

  def sortedArray=unsortedArray.sort({ a, b -> 
   def (x1, y1, z1) = a.split("\\.").collect { it.toInteger() }
   def (x2, y2, z2) = b.split("\\.").collect { it.toInteger() }
   (x1 <=> x2).asBoolean() ? x1 <=> x2 : 
   (y1 <=> y2).asBoolean() ? y1 <=> y2 : z1 <=> z2
  })

  println sortedArray
  }
 }

 task incrementVersion {
   doLast{
    def versionName = version.split("\\.")
    def last = Integer.parseInt(versionName[versionName.length - 1])
    versionName[versionName.length - 1] = Integer.toString(last + 1)
    versionName = versionName.join(".")
    println versionName

    ant.propertyfile(file: "gradle.properties") {
        entry(key: "version", value: versionName)
    }
  }
 }



